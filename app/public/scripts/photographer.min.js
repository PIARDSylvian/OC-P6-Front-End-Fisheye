class PhotographerModelPage extends AbstractModelPhotographer{constructor(e){super(e),this._picture="assets/photographers/Photographers ID Photos/"+e.portrait,this._id=e.id,this._city=e.city,this._country=e.country,this._tagline=e.tagline,this._price=e.price}getUserPageDOM(){return new PhotographerTemplatePage(this).getRender()}}class AbstractModelMedia{constructor(e,t){if(this.constructor===AbstractModelMedia)throw new TypeError('Abstract class "AbstractModelMedia" cannot be instantiated directly');this._date=e.date,this._id=e.id,this._likes=e.likes,this._photographerId=e.photographerId,this._photographerName=this.getFirstName(t),this._price=e.price,this._title=e.title}getFirstName(e){return e.split(" ")[0].replace("-"," ")}getMediaCardDOM(){var e=document.createElement("article"),t=document.createElement("h3"),a=(t.textContent=this._title,document.createElement("p"));return a.textContent=this._likes,e.appendChild(t),e.appendChild(a),e}}class PhotographerImageCard extends AbstractModelMedia{constructor(e,t){super(e,t),this._image=`assets/photographers/${this._photographerName}/`+e.image}getMediaCardDOM(){return new PhotographerTemplateImage(this).getRender()}}class PhotographerVideoCard extends AbstractModelMedia{constructor(e,t){super(e,t),this._video=`assets/photographers/${this._photographerName}/`+e.video}getMediaCardDOM(){return new PhotographerTemplateVideo(this).getRender()}}class PhotographerTemplatePage extends AbstractTemplatePhotographer{constructor(e){super(e),this._id=e._id,this._city=e._city,this._country=e._country,this._tagline=e._tagline,this._price=e._price}getRender(){var e=super.getRender(),t=e.querySelector("img"),a=(t.setAttribute("alt",this._name),t.classList.add("photographer__picture"),document.createElement("div")),e=e.querySelector("h2"),e=(e.classList.add("photographer__title"),a.appendChild(e),document.createElement("p")),e=(e.textContent=this._city+", "+this._country,e.classList.add("photographer__location"),a.appendChild(e),document.createElement("p")),e=(e.textContent=this._tagline,e.classList.add("photographer__tagline"),a.appendChild(e),document.createElement("p"));return e.textContent=this._price+"€ / jour",e.classList.add("photographer__price"),{image:t,info:a,price:e}}}class AbstractTemplateMedia{constructor(e){if(this.constructor===AbstractTemplateMedia)throw new TypeError('Abstract class "AbstractTemplateMedia" cannot be instantiated directly');this._date=e._date,this._id=e._id,this._likes=e._likes,this._photographerId=e._photographerId,this._photographerName=e._photographerName,this._price=e._price,this._title=e._title}getRender(){var e=document.createElement("figure"),t=document.createElement("figcaption"),a=(t.innerText=this._title,document.createElement("div")),r=(a.classList.add("like_count"),document.createElement("p")),r=(r.innerText=this._likes,a.appendChild(r),document.createElement("img"));return r.setAttribute("src","assets/icons/heart.svg"),r.setAttribute("alt","like"),a.appendChild(r),{figure:e,figcaption:t,like:a}}}class PhotographerTemplateImage extends AbstractTemplateMedia{constructor(e){super(e),this._image=e._image}getRender(){var{figure:e,figcaption:t,like:a}=super.getRender(),r=document.createElement("img");return r.setAttribute("src",this._image),r.setAttribute("alt",this._title),e.appendChild(r),e.appendChild(t),e.appendChild(a),e}}class PhotographerTemplateVideo extends AbstractTemplateMedia{constructor(e){super(e),this._video=e._video}getRender(){var{figure:e,figcaption:t,like:a}=super.getRender(),r=document.createElement("video"),i=document.createElement("source");return i.setAttribute("src",this._video),i.setAttribute("type","video/mp4"),r.appendChild(i),e.appendChild(r),e.appendChild(t),e.appendChild(a),e}}function mediaFactory(e,t){if(e.image)return new PhotographerImageCard(e,t);if(e.video)return new PhotographerVideoCard(e,t);throw"Unknown media format"}function getUrlParmeterId(){return window.location.hash.substring(1)}async function getPhotographer(a){return await getPhotographers().then(e=>{var t=e.photographers.find(e=>e.id==a);return t.media=e.media.filter(e=>e.photographerId==a),t})}function addCarouselBase(){const a=document.createElement("div");a.classList.add("carousel"),a.dataset.idx=0;var e=document.createElement("button"),t=(e.innerText="<",document.createElement("button"));t.innerText=">";const r=document.createElement("div");return r.classList.add("carousel__content"),a.append(e,r,t),e.addEventListener("click",()=>{elements=r.querySelectorAll(".carousel__content>*");var e=+a.dataset.idx-1;a.dataset.idx=e<0?elements.length-1:e,elements.forEach((e,t)=>{t===+a.dataset.idx?e.setAttribute("aria-hidden",!1):e.setAttribute("aria-hidden",!0)})}),t.addEventListener("click",()=>{elements=r.querySelectorAll(".carousel__content>*");var e=+a.dataset.idx+1;e>elements.length-1?a.dataset.idx=0:a.dataset.idx=e,elements.forEach((e,t)=>{t===+a.dataset.idx?e.setAttribute("aria-hidden",!1):e.setAttribute("aria-hidden",!0)})}),a}async function displayData(e){var t=document.querySelector(".photographer__header"),a=photographerFactory(e,e.id).getUserPageDOM();t.prepend(a.info),t.append(a.image);let r=0;e.media.forEach(e=>r+=e.likes),AddTotalLikeAndPrice(r,a.price);t=addModal(addCarouselBase(),e=>{{const a=document.querySelector(".modal .carousel");a.dataset.idx=e.composedPath().find(e=>"FIGURE"===e.tagName).dataset.idx,a.querySelectorAll(".carousel__content>div").forEach((e,t)=>{t==a.dataset.idx?e.setAttribute("aria-hidden",!1):e.setAttribute("aria-hidden",!0)})}},e=>{console.log("close :",e)});AddMedia(e.media,e.name,t)}function sortMedia(e,t){switch(t){case"2":e.sort((e,t)=>e.title<t.title?-1:e.title>t.title?1:0);break;case"1":e.sort((e,t)=>new Date(t.date)-new Date(e.date));break;default:e.sort((e,t)=>t.likes-e.likes)}return e}function AddMedia(t,d,n){const s=document.querySelector(".photographer__section__media-wrapper"),a=(t=sortMedia(t),s.dataset.sort="0",t.forEach((e,t)=>{var e=mediaFactory(e,d).getMediaCardDOM(),a=(e.dataset.idx=t,e.querySelector("img, video")),a=(a.addEventListener("click",e=>n(e)),a.cloneNode(!0)),r=("VIDEO"===a.tagName&&a.setAttribute("controls",""),document.createElement("h3")),i=(r.innerText=e.getElementsByTagName("figcaption")[0].innerText,document.createElement("div"));i.append(a,r),i.setAttribute("aria-hidden",!0),0==t&&i.setAttribute("aria-hidden",!1),document.querySelector(".carousel__content").append(i),s.appendChild(e)}),document.querySelector("#listbox_sort_by"));a.addEventListener("blur",function(){var e=a.querySelector('li[aria-selected="true"]').dataset.value;e!==s.dataset.sort&&(s.innerHTML="",s.dataset.sort=e,sortMedia(t,e).forEach((e,t)=>{var e=mediaFactory(e,d).getMediaCardDOM(),a=(e.dataset.idx=t,e.querySelector("img, video")),a=(a.addEventListener("click",e=>n(e)),a.cloneNode(!0)),r=("VIDEO"===a.tagName&&a.setAttribute("controls",""),document.createElement("h3")),i=(r.innerText=e.getElementsByTagName("figcaption")[0].innerText,document.createElement("div"));i.append(a,r),i.setAttribute("aria-hidden",!0),0==t&&i.setAttribute("aria-hidden",!1),document.querySelector(".carousel__content").append(i),s.appendChild(e)}))})}function AddTotalLikeAndPrice(e,t){var a=document.createElement("div"),r=(a.classList.add("photographer__like-and-price"),document.createElement("div")),i=document.createElement("p"),e=(i.innerText=e,document.createElement("img"));e.setAttribute("src","assets/icons/heart.svg"),e.setAttribute("alt","like"),r.appendChild(i),r.appendChild(e),a.appendChild(r),a.appendChild(t),document.querySelector("main").append(a)}function addModal(e,t=()=>{},a=()=>{}){const r=document.querySelector("main"),i=document.createElement("div"),d=(i.setAttribute("role","dialog"),i.setAttribute("aria-hidden",!0),i.classList.add("modal"),document.createElement("img"));d.setAttribute("src","assets/icons/close.svg"),d.setAttribute("alt","close"),i.appendChild(d),i.appendChild(e),document.addEventListener("click",()=>{document.querySelector(".modal.open[aria-hidden='false']")&&d.click()}),i.addEventListener("click",e=>e.stopPropagation()),d.addEventListener("click",e=>{a(e),r.setAttribute("aria-hidden",!1),i.setAttribute("aria-hidden",!0),i.classList.remove("open"),document.body.style.overflow="auto"});return document.body.appendChild(i),e=>{document.querySelector(".modal.open[aria-hidden='false']")||(t(e),document.body.style.overflow="hidden",r.setAttribute("aria-hidden",!0),i.setAttribute("aria-hidden",!1),i.style.top=`calc(50% + ${window.scrollY}px)`,setTimeout(()=>i.classList.add("open"),10))}}function CustomSelect(e,t,a){this._data=a,this._id=e,this._name=t,this._idx=0;const r=()=>{const r=document.createElement("ul");return r.setAttribute("id","listbox_"+this._id),r.setAttribute("role","listbox"),r.setAttribute("aria-labelledby","label_"+this._id),r.setAttribute("tabindex",-1),this._data.map((e,t)=>{var a=document.createElement("li");a.setAttribute("id",this._id+"_"+t),a.setAttribute("role","option"),a.setAttribute("aria-selected",""+(0===t)),a.dataset.value=t,a.innerText=e,0===t&&a.classList.add("select"),r.append(a)}),r},i=(e,t)=>{switch(e){case"ArrowDown":return this._idx==t.length-1?d(0,t):d(this._idx+1,t),!0;case"ArrowUp":return 0==this._idx?d(t.length-1,t):d(this._idx-1,t),!0;case"Enter":case" ":return n(t[this._idx],t),!1;default:return!1}},d=(e,t)=>{this._idx=e,t.forEach((e,t)=>{t!==this._idx?e.classList.remove("select"):e.classList.add("select")})},n=(t,e)=>{const a=document.querySelector("#listbox_"+this._id);e.forEach(e=>{e!==t&&a.appendChild(e)}),"false"===t.ariaSelected&&e.forEach(e=>e.ariaSelected=t===e)};{(e=document.createElement("label")).innerText=this._name,e.setAttribute("id","label_"+this._id),e.setAttribute("for",this._id);const s=document.createElement("button"),o=(s.setAttribute("id",this._id),s.setAttribute("role","button"),s.setAttribute("aria-haspopup","listbox"),s.setAttribute("aria-expanded",!1),s.setAttribute("aria-controls","listbox_"+this._id),s.setAttribute("aria-labelledby","label_"+this._id),s.setAttribute("tabindex",0),s.setAttribute("type","button"),s.innerText=a[0],r());return(t=document.createElement("div")).classList.add("custom_select"),t.append(e,s,o),s.addEventListener("blur",function(){o.classList.contains("is-open")&&(s.style.zIndex=-1)}),o.addEventListener("blur",function(){o.classList.remove("is-open"),o.style.height="3em",s.style.zIndex=2,this._idx=0,s.innerText=o.querySelector('li[aria-selected="true"]').innerText,s.setAttribute("aria-expanded",!1)}),s.addEventListener("click",function(e){o.classList.add("is-open"),o.style.height="9em",s.setAttribute("aria-expanded",!0),1==e.pointerId&&o.querySelector("li").classList.remove("select"),o.focus()}),o.addEventListener("keydown",function(e){var t=o.querySelectorAll("li");i(e.key,t)||o.blur()}),o.addEventListener("click",function(e){var t=o.querySelectorAll("li");n(e.target,t),o.blur()}),t}}async function init(){var e=await getPhotographer(getUrlParmeterId()),t=new CustomSelect("sort_by","Trier par",["Popularité","Date","Titre"]);document.querySelector(".photographer__section nav").append(t),displayData(e)}function displayModal(){document.getElementById("contact_modal").style.display="block"}function closeModal(){document.getElementById("contact_modal").style.display="none"}init();