class PhotographerModelPage extends AbstractModelPhotographer{constructor(e){super(e),this._picture="assets/photographers/Photographers ID Photos/"+e.portrait,this._id=e.id,this._city=e.city,this._country=e.country,this._tagline=e.tagline,this._price=e.price}getUserPageDOM(){return new PhotographerTemplatePage(this).getRender()}}class AbstractModelMedia{constructor(e,t){if(this.constructor===AbstractModelMedia)throw new TypeError('Abstract class "AbstractModelMedia" cannot be instantiated directly');this._date=e.date,this._id=e.id,this._likes=e.likes,this._photographerId=e.photographerId,this._photographerName=this.getFirstName(t),this._price=e.price,this._title=e.title}getFirstName(e){return e.split(" ")[0].replace("-"," ")}getMediaCardDOM(){var e=document.createElement("article"),t=document.createElement("h3"),r=(t.textContent=this._title,document.createElement("p"));return r.textContent=this._likes,e.appendChild(t),e.appendChild(r),e}}class PhotographerImageCard extends AbstractModelMedia{constructor(e,t){super(e,t),this._image=`assets/photographers/${this._photographerName}/`+e.image}getMediaCardDOM(){return new PhotographerTemplateImage(this).getRender()}}class PhotographerVideoCard extends AbstractModelMedia{constructor(e,t){super(e,t),this._video=`assets/photographers/${this._photographerName}/`+e.video}getMediaCardDOM(){return new PhotographerTemplateVideo(this).getRender()}}class PhotographerTemplatePage extends AbstractTemplatePhotographer{constructor(e){super(e),this._id=e._id,this._city=e._city,this._country=e._country,this._tagline=e._tagline,this._price=e._price}getRender(){var e=super.getRender(),t=e.querySelector("img"),r=(t.setAttribute("alt",this._name),t.classList.add("photographer__picture"),document.createElement("div")),e=e.querySelector("h2"),e=(e.classList.add("photographer__title"),r.appendChild(e),document.createElement("p")),e=(e.textContent=this._city+", "+this._country,e.classList.add("photographer__location"),r.appendChild(e),document.createElement("p")),e=(e.textContent=this._tagline,e.classList.add("photographer__tagline"),r.appendChild(e),document.createElement("p"));return e.textContent=this._price+"€/jour",e.classList.add("photographer__price"),{image:t,info:r,price:e}}}class AbstractTemplateMedia{constructor(e){if(this.constructor===AbstractTemplateMedia)throw new TypeError('Abstract class "AbstractTemplateMedia" cannot be instantiated directly');this._date=e._date,this._id=e._id,this._likes=e._likes,this._photographerId=e._photographerId,this._photographerName=e._photographerName,this._price=e._price,this._title=e._title}getRender(){var e=document.createElement("figure"),t=document.createElement("figcaption"),r=(t.innerText=this._title,document.createElement("div")),i=(r.classList.add("like_count"),document.createElement("p")),i=(i.innerText=this._likes,r.appendChild(i),document.createElement("img"));return i.setAttribute("src","assets/icons/heart.svg"),i.setAttribute("alt","like"),r.appendChild(i),{figure:e,figcaption:t,like:r}}}class PhotographerTemplateImage extends AbstractTemplateMedia{constructor(e){super(e),this._image=e._image}getRender(){var{figure:e,figcaption:t,like:r}=super.getRender(),i=document.createElement("img");return i.setAttribute("src",this._image),i.setAttribute("alt",this._title),e.appendChild(i),e.appendChild(t),e.appendChild(r),e}}class PhotographerTemplateVideo extends AbstractTemplateMedia{constructor(e){super(e),this._video=e._video}getRender(){var{figure:e,figcaption:t,like:r}=super.getRender(),i=document.createElement("video"),a=(i.setAttribute("controls",""),document.createElement("source"));return a.setAttribute("src",this._video),a.setAttribute("type","video/mp4"),i.appendChild(a),e.appendChild(i),e.appendChild(t),e.appendChild(r),e}}function mediaFactory(e,t){if(e.image)return new PhotographerImageCard(e,t);if(e.video)return new PhotographerVideoCard(e,t);throw"Unknown media format"}function getUrlParmeterId(){return window.location.hash.substring(1)}async function getPhotographer(r){return await getPhotographers().then(e=>{let t;return e.photographers.forEach(e=>{e.id==r&&(t=e)}),t.media=[],e.media.forEach(e=>{e.photographerId==r&&t.media.push(e)}),t})}async function displayData(e){var t=document.querySelector(".photographer__header"),r=photographerFactory(e,e.id).getUserPageDOM();t.prepend(r.info),t.append(r.image),AddMedia(e.media,e.name),console.log(r.price)}function AddMedia(e,t){const r=document.querySelector(".photographer__section__media-wrapper");e.forEach(e=>{e=mediaFactory(e,t);r.appendChild(e.getMediaCardDOM())})}function CustomSelect(e,t,r){this._data=r,this._id=e,this._name=t,this._idx=0;const i=()=>{const i=document.createElement("ul");return i.setAttribute("id","listbox_"+this._id),i.setAttribute("role","listbox"),i.setAttribute("aria-labelledby","label_"+this._id),i.setAttribute("tabindex",-1),this._data.map((e,t)=>{var r=document.createElement("li");r.setAttribute("id",this._id+"_"+t),r.setAttribute("role","option"),r.setAttribute("aria-selected",""+(0===t)),r.dataset.value=t,r.innerText=e,0===t&&r.classList.add("select"),i.append(r)}),i},a=(e,t)=>{switch(e){case"ArrowDown":return this._idx==t.length-1?s(0,t):s(this._idx+1,t),!0;case"ArrowUp":return 0==this._idx?s(t.length-1,t):s(this._idx-1,t),!0;case"Enter":case" ":return o(t[this._idx],t),!1;default:return!1}},s=(e,t)=>{this._idx=e,t.forEach((e,t)=>{t!==this._idx?e.classList.remove("select"):e.classList.add("select")})},o=(t,e)=>{const r=document.querySelector("#listbox_"+this._id);e.forEach(e=>{e!==t&&r.appendChild(e)}),"false"===t.ariaSelected&&e.forEach(e=>e.ariaSelected=t===e)};{(e=document.createElement("label")).innerText=this._name,e.setAttribute("id","label_"+this._id),e.setAttribute("for",this._id);const n=document.createElement("button"),d=(n.setAttribute("id",this._id),n.setAttribute("role","button"),n.setAttribute("aria-haspopup","listbox"),n.setAttribute("aria-expanded",!1),n.setAttribute("aria-controls","listbox_"+this._id),n.setAttribute("aria-labelledby","label_"+this._id),n.setAttribute("tabindex",0),n.setAttribute("type","button"),n.innerText=r[0],i());return(t=document.createElement("div")).classList.add("custom_select"),t.append(e,n,d),n.addEventListener("blur",function(){d.classList.contains("is-open")&&(n.style.display="none")}),d.addEventListener("blur",function(){d.classList.remove("is-open"),n.style.display="block",this._idx=0,n.innerText=d.querySelector('li[aria-selected="true"]').innerText,n.setAttribute("aria-expanded",!1)}),n.addEventListener("click",function(e){d.classList.add("is-open"),n.setAttribute("aria-expanded",!0),1==e.pointerId&&d.querySelector("li").classList.remove("select"),d.focus()}),d.addEventListener("keydown",function(e){var t=d.querySelectorAll("li");a(e.key,t)||d.blur()}),d.addEventListener("click",function(e){var t=d.querySelectorAll("li");o(e.target,t),d.blur()}),t}}async function init(){displayData(await getPhotographer(getUrlParmeterId()));var e=new CustomSelect("sort_by","Trier par",["Popularité","Date","Titre"]);document.querySelector(".photographer__section nav").append(e)}init();